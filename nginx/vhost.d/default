location /uploads/ {
    alias /uploads/;
    autoindex off;

    add_header X-Content-Type-Options nosniff always;
    add_header Content-Security-Policy "default-src 'none'; img-src 'self' data:; style-src 'self' 'unsafe-inline';" always;

    types {
        image/jpeg  jpg jpeg;
        image/png   png;
        image/webp  webp;
        application/pdf pdf;
    }
    default_type application/octet-stream;

    expires 30d;
    add_header Cache-Control "public, max-age=2592000, immutable";
}

location ~* ^/uploads/.*\.(php|phtml|phar|js|html|htm|svg|sh|exe|dll)$ {
    return 404;
}
